(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{285:(e,t,a)=>{"use strict";a.d(t,{$:()=>l});var s=a(5155);a(2115);var r=a(9708),n=a(2085),i=a(9434);let o=(0,n.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all cursor-pointer disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",{variants:{variant:{default:"bg-primary text-primary-foreground shadow-xs hover:bg-primary/90",destructive:"bg-destructive text-white shadow-xs hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50",secondary:"bg-secondary text-secondary-foreground shadow-xs hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2 has-[>svg]:px-3",sm:"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5",lg:"h-10 rounded-md px-6 has-[>svg]:px-4",icon:"size-9"}},defaultVariants:{variant:"default",size:"default"}});function l(e){let{className:t,variant:a,size:n,asChild:l=!1,...d}=e,c=l?r.DX:"button";return(0,s.jsx)(c,{"data-slot":"button",className:(0,i.cn)(o({variant:a,size:n,className:t})),...d})}},4557:(e,t,a)=>{Promise.resolve().then(a.bind(a,7756))},6102:(e,t,a)=>{"use strict";a.d(t,{Bc:()=>i,ZI:()=>d,k$:()=>l,m_:()=>o});var s=a(5155);a(2115);var r=a(9613),n=a(9434);function i(e){let{delayDuration:t=0,...a}=e;return(0,s.jsx)(r.Kq,{"data-slot":"tooltip-provider",delayDuration:t,...a})}function o(e){let{...t}=e;return(0,s.jsx)(i,{children:(0,s.jsx)(r.bL,{"data-slot":"tooltip",...t})})}function l(e){let{...t}=e;return(0,s.jsx)(r.l9,{"data-slot":"tooltip-trigger",...t})}function d(e){let{className:t,sideOffset:a=0,children:i,...o}=e;return(0,s.jsx)(r.ZL,{children:(0,s.jsxs)(r.UC,{"data-slot":"tooltip-content",sideOffset:a,className:(0,n.cn)("bg-primary text-primary-foreground animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 w-fit origin-(--radix-tooltip-content-transform-origin) rounded-md px-3 py-1.5 text-xs text-balance",t),...o,children:[i,(0,s.jsx)(r.i3,{className:"bg-primary fill-primary z-50 size-2.5 translate-y-[calc(-50%_-_2px)] rotate-45 rounded-[2px]"})]})})}},6126:(e,t,a)=>{"use strict";a.d(t,{E:()=>o});var s=a(5155);a(2115);var r=a(2085),n=a(9434);let i=(0,r.F)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function o(e){let{className:t,variant:a,...r}=e;return(0,s.jsx)("div",{className:(0,n.cn)(i({variant:a}),t),...r})}},7280:(e,t,a)=>{"use strict";a.d(t,{D:()=>o,ThemeProvider:()=>i});var s=a(5155),r=a(2115);let n=(0,r.createContext)({theme:"system",setTheme:()=>null,darkMode:!1,toggleDarkMode:()=>null});function i(e){let{children:t,defaultTheme:a="system",enableSystem:i=!0,attribute:o="data-theme"}=e,[l,d]=(0,r.useState)(a),[c,u]=(0,r.useState)("dark"===a);return(0,r.useEffect)(()=>{let e=window.document.documentElement;if(e.classList.remove("light","dark"),"system"===l&&i){let t=window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light";e.classList.add(t),u("dark"===t)}else e.classList.add(l),u("dark"===l)},[l,i]),(0,s.jsx)(n.Provider,{value:{theme:l,setTheme:d,darkMode:c,toggleDarkMode:()=>{d(c?"light":"dark")}},children:t})}let o=()=>{let e=(0,r.useContext)(n);if(void 0===e)throw Error("useTheme must be used within a ThemeProvider");return e}},7313:(e,t,a)=>{"use strict";a.d(t,{Xi:()=>l,av:()=>d,j7:()=>o,tU:()=>i});var s=a(5155);a(2115);var r=a(64),n=a(9434);function i(e){let{className:t,...a}=e;return(0,s.jsx)(r.bL,{"data-slot":"tabs",className:(0,n.cn)("flex flex-col gap-2",t),...a})}function o(e){let{className:t,...a}=e;return(0,s.jsx)(r.B8,{"data-slot":"tabs-list",className:(0,n.cn)("bg-muted text-muted-foreground inline-flex h-9 w-fit items-center justify-center rounded-lg p-[3px]",t),...a})}function l(e){let{className:t,...a}=e;return(0,s.jsx)(r.l9,{"data-slot":"tabs-trigger",className:(0,n.cn)("data-[state=active]:bg-background dark:data-[state=active]:text-foreground focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:outline-ring dark:data-[state=active]:border-input dark:data-[state=active]:bg-input/30 text-foreground dark:text-muted-foreground inline-flex h-[calc(100%-1px)] flex-1 items-center justify-center gap-1.5 rounded-md border border-transparent px-2 py-1 text-sm font-medium whitespace-nowrap transition-[color,box-shadow] focus-visible:ring-[3px] focus-visible:outline-1 cursor-pointer disabled:pointer-events-none disabled:opacity-50 data-[state=active]:shadow-sm [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",t),...a})}function d(e){let{className:t,...a}=e;return(0,s.jsx)(r.UC,{"data-slot":"tabs-content",className:(0,n.cn)("flex-1 outline-none",t),...a})}},7652:(e,t,a)=>{"use strict";a.d(t,{_K:()=>i,um:()=>r,zi:()=>n});let s="http://0.0.0.0:5001/api";async function r(e){for(let t=1;t<=3;t++)try{console.log("Fetching trace with ID ".concat(e," (attempt ").concat(t,"/").concat(3,")..."));let a=await fetch("".concat(s,"/traces/").concat(e,"/spans"));if(!a.ok){let e=await a.text();throw console.error("Error fetching trace: ".concat(a.status," ").concat(a.statusText),e),Error("Error fetching trace: ".concat(a.statusText))}let r=await a.json();return console.log("Successfully fetched trace data:",r),r}catch(a){if(console.error("Failed to fetch trace with ID ".concat(e," (attempt ").concat(t,"/").concat(3,"):"),a),3===t)throw a;await new Promise(e=>setTimeout(e,500*Math.pow(2,t-1)))}}async function n(e){for(let t=1;t<=3;t++)try{console.log("Fetching span details for ID ".concat(e," (attempt ").concat(t,"/").concat(3,")..."));let a=await fetch("".concat(s,"/span/").concat(e,"/details"));if(!a.ok){let e=await a.text();throw console.error("Error fetching span details: ".concat(a.status," ").concat(a.statusText),e),Error("Error fetching span details: ".concat(a.statusText))}let r=await a.json();return console.log("Successfully fetched span details:",r),r}catch(a){if(console.error("Failed to fetch span details with ID ".concat(e," (attempt ").concat(t,"/").concat(3,"):"),a),3===t)throw a;await new Promise(e=>setTimeout(e,500*Math.pow(2,t-1)))}throw Error("Failed to fetch span details")}async function i(){console.log("getAllTraces CALLED");for(let e=1;e<=3;e++)try{console.log("Fetching all traces (attempt ".concat(e,"/").concat(3,")..."));let t=await fetch("".concat(s,"/traces"));if(!t.ok){let e=await t.text();throw console.error("Error fetching traces: ".concat(t.status," ").concat(t.statusText),e),Error("Error fetching traces: ".concat(t.statusText))}let a=await t.json();return console.log("Successfully fetched all traces:",a),a}catch(t){if(console.error("Failed to fetch all traces (attempt ".concat(e,"/").concat(3,"):"),t),3===e)throw t;await new Promise(t=>setTimeout(t,500*Math.pow(2,e-1)))}return[]}},7756:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>eM});var s=a(5155),r=a(2115),n=a(5143),i=a(402),o=a(6268),l=a(8266),d=a(4392),c=a(2957),u=a(9318),m=a(7029),x=a(5695),h=a(9434),g=a(5594),p=a(1032),f=a(6126);let b=g.z.object({args:g.z.record(g.z.string()),duration:g.z.number(),name:g.z.string(),output:g.z.string(),span_id:g.z.string()}),v=g.z.object({duration:g.z.number(),end_time:g.z.number(),final_completion:g.z.string(),name:g.z.string(),span_id:g.z.string(),start_time:g.z.number(),tools_called:g.z.array(b)});g.z.object({id:g.z.string().or(g.z.number()),name:g.z.string(),session_id:g.z.string(),started_at:g.z.string().or(g.z.number()),ended_at:g.z.string().or(g.z.number()),metadata:g.z.string(),spans:g.z.array(v).optional()});var j=a(285),y=a(968);function w(e){let{className:t,...a}=e;return(0,s.jsx)(y.b,{"data-slot":"label",className:(0,h.cn)("flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50",t),...a})}var N=a(4582),k=a(6474),S=a(5196),_=a(7863);function E(e){let{...t}=e;return(0,s.jsx)(N.bL,{"data-slot":"select",...t})}function C(e){let{...t}=e;return(0,s.jsx)(N.WT,{"data-slot":"select-value",...t})}function T(e){let{className:t,size:a="default",children:r,...n}=e;return(0,s.jsxs)(N.l9,{"data-slot":"select-trigger","data-size":a,className:(0,h.cn)("border-input data-[placeholder]:text-muted-foreground [&_svg:not([class*='text-'])]:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 dark:hover:bg-input/50 flex w-fit items-center justify-between gap-2 rounded-md border bg-transparent px-3 py-2 text-sm whitespace-nowrap shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 data-[size=default]:h-9 data-[size=sm]:h-8 *:data-[slot=select-value]:line-clamp-1 *:data-[slot=select-value]:flex *:data-[slot=select-value]:items-center *:data-[slot=select-value]:gap-2 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",t),...n,children:[r,(0,s.jsx)(N.In,{asChild:!0,children:(0,s.jsx)(k.A,{className:"size-4 opacity-50"})})]})}function z(e){let{className:t,children:a,position:r="popper",...n}=e;return(0,s.jsx)(N.ZL,{children:(0,s.jsxs)(N.UC,{"data-slot":"select-content",className:(0,h.cn)("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 relative z-50 max-h-(--radix-select-content-available-height) min-w-[8rem] origin-(--radix-select-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border shadow-md","popper"===r&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",t),position:r,...n,children:[(0,s.jsx)(P,{}),(0,s.jsx)(N.LM,{className:(0,h.cn)("p-1","popper"===r&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)] scroll-my-1"),children:a}),(0,s.jsx)(F,{})]})})}function A(e){let{className:t,children:a,...r}=e;return(0,s.jsxs)(N.q7,{"data-slot":"select-item",className:(0,h.cn)("focus:bg-accent focus:text-accent-foreground [&_svg:not([class*='text-'])]:text-muted-foreground relative flex w-full cursor-default items-center gap-2 rounded-sm py-1.5 pr-8 pl-2 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4 *:[span]:last:flex *:[span]:last:items-center *:[span]:last:gap-2",t),...r,children:[(0,s.jsx)("span",{className:"absolute right-2 flex size-3.5 items-center justify-center",children:(0,s.jsx)(N.VF,{children:(0,s.jsx)(S.A,{className:"size-4"})})}),(0,s.jsx)(N.p4,{children:a})]})}function P(e){let{className:t,...a}=e;return(0,s.jsx)(N.PP,{"data-slot":"select-scroll-up-button",className:(0,h.cn)("flex cursor-default items-center justify-center py-1",t),...a,children:(0,s.jsx)(_.A,{className:"size-4"})})}function F(e){let{className:t,...a}=e;return(0,s.jsx)(N.wn,{"data-slot":"select-scroll-down-button",className:(0,h.cn)("flex cursor-default items-center justify-center py-1",t),...a,children:(0,s.jsx)(k.A,{className:"size-4"})})}var M=a(7313);let I=[{accessorKey:"id",header:"Id",cell:e=>{let{row:t}=e;return(0,s.jsx)("div",{className:"w-full text-base overflow-hidden text-ellipsis",children:(0,s.jsx)("div",{className:"truncate",children:t.original.id})})},size:320},{accessorKey:"name",header:"Name",cell:e=>{let{row:t}=e;return(0,s.jsx)("div",{className:"w-full text-base overflow-hidden text-ellipsis",children:(0,s.jsx)("div",{className:"truncate",children:t.original.name})})},size:200},{accessorKey:"latency",header:"Latency",cell:e=>{let{row:t}=e,a=Number(t.original.ended_at)-Number(t.original.started_at);return(0,s.jsx)("div",{className:"w-full text-base overflow-hidden text-ellipsis",children:(0,s.jsxs)("div",{className:"truncate",children:[a.toFixed(2),"s"]})})},size:200},{accessorKey:"metadata",header:"Metadata",cell:e=>{let{row:t}=e;try{let e=JSON.parse(t.original.metadata),a=["status","priority","user_id"],r=Object.keys(e).filter(e=>a.includes(e)).slice(0,3);if(0===r.length)return(0,s.jsx)("div",{className:"w-full text-sm text-muted-foreground overflow-hidden text-ellipsis px-2",children:"No priority metadata"});return(0,s.jsx)("div",{className:"w-full text-sm overflow-hidden px-2",children:(0,s.jsx)("div",{className:"flex flex-wrap gap-1",children:r.map(t=>(0,s.jsxs)("div",{className:"text-xs bg-muted px-2 py-1 rounded",children:[t,": ",String(e[t])]},t))})})}catch(e){return(0,s.jsx)("div",{className:"w-full text-sm text-muted-foreground overflow-hidden text-ellipsis px-2",children:"Invalid metadata"})}},size:200}];function O(e){let{row:t,onRowClick:a}=e,{transform:r,transition:n,setNodeRef:d,isDragging:c}=(0,i.gl)({id:t.original.id});return(0,s.jsx)("tr",{"data-state":t.getIsSelected()&&"selected","data-dragging":c,ref:d,className:(0,h.cn)("relative z-0 data-[dragging=true]:z-10 data-[dragging=true]:opacity-80","hover:bg-primary/5 even:bg-muted/30 transition-colors cursor-pointer",c&&"shadow-lg scale-[1.01] ring-2 ring-primary rounded-xl"),style:{transform:l.Ks.Transform.toString(r),transition:n},onClick:()=>{a(t.original.id)},tabIndex:0,children:t.getVisibleCells().map((e,t)=>(0,s.jsx)("td",{className:(0,h.cn)("px-4 py-3 align-middle whitespace-nowrap overflow-hidden text-base border-b focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-primary",0===t&&"sticky left-0 z-10 bg-background"),style:{width:150!==e.column.getSize()?"".concat(e.column.getSize(),"px"):void 0},children:(0,o.Kv)(e.column.columnDef.cell,e.getContext())},e.id))})}function R(e){var t;let{data:a}=e,[l,g]=(0,r.useState)(()=>a),{table:b}=function(e){let[t,a]=(0,r.useState)([]),[n,i]=(0,r.useState)([]),[l,d]=(0,r.useState)({}),[c,u]=(0,r.useState)({}),[m,x]=(0,r.useState)([]),h=(0,r.useMemo)(()=>[{accessorKey:"id",header:"ID",cell:e=>{let{row:t}=e;return(0,s.jsx)("div",{className:"font-mono text-sm px-4 py-3",children:t.getValue("id")})}},{accessorKey:"name",header:"Name",cell:e=>{let{row:t}=e;return(0,s.jsx)("div",{className:"font-medium text-base px-4 py-3",children:t.getValue("name")})}},{accessorKey:"session_id",header:"Session",cell:e=>{let{row:t}=e;return(0,s.jsx)("div",{className:"px-4 py-3",children:(0,s.jsx)(f.E,{variant:"outline",className:"font-mono text-sm",children:t.getValue("session_id")})})}},{id:"latency",header:"Latency",cell:e=>{let{row:t}=e;try{let e,a=t.original,r=a.started_at,n=a.ended_at;if(!r||!n)return(0,s.jsx)("div",{className:"text-sm text-muted-foreground px-4 py-3",children:"Missing data"});let i=new Date(r),o=new Date(n);if(isNaN(i.getTime())||isNaN(o.getTime()))return(0,s.jsx)("div",{className:"text-sm text-muted-foreground px-4 py-3",children:"Invalid dates"});let l=o.getTime()-i.getTime();if(l<0)return(0,s.jsx)("div",{className:"text-sm text-muted-foreground px-4 py-3",children:"Invalid duration"});if(l<1e3)e="".concat(l,"ms");else if(l<6e4)e="".concat((l/1e3).toFixed(2),"s");else{let t=Math.floor(l/6e4),a=Math.floor(l%6e4/1e3);e="".concat(t,"m ").concat(a,"s")}return(0,s.jsx)("div",{className:"text-base font-medium px-4 py-3",children:e})}catch(e){return console.error("Latency calculation error:",e),(0,s.jsx)("div",{className:"text-sm text-muted-foreground px-4 py-3",children:"Error"})}}},{accessorKey:"metadata",header:"Metadata",cell:e=>{let{row:t}=e;try{let e=JSON.parse(t.getValue("metadata")),a=["status","priority","user_id"],r=Object.keys(e).filter(e=>a.includes(e)).slice(0,3);return(0,s.jsx)("div",{className:"text-sm px-4 py-3",children:r.length>0?(0,s.jsx)("div",{className:"flex flex-wrap gap-2",children:r.map(t=>(0,s.jsxs)(f.E,{variant:"outline",className:"text-xs",children:[t,": ",String(e[t])]},t))}):(0,s.jsx)("div",{className:"text-xs text-muted-foreground",children:"No priority metadata"})})}catch(e){return(0,s.jsx)("div",{className:"text-xs text-muted-foreground px-4 py-3",children:"Invalid metadata"})}}}],[]),g=Array.isArray(e)?e:e.data,b=Array.isArray(e)?h:e.columns;return{table:(0,o.N4)({data:g,columns:b,state:{sorting:t,columnFilters:n,columnVisibility:l,rowSelection:c},enableRowSelection:!0,onRowSelectionChange:u,onSortingChange:a,onColumnFiltersChange:i,onColumnVisibilityChange:d,getCoreRowModel:(0,p.HT)(),getPaginationRowModel:(0,p.kW)(),getSortedRowModel:(0,p.h5)(),getFilteredRowModel:(0,p.hM)()}),columns:b,selectedTraces:m,toggleTraceSelection:e=>{x(t=>t.includes(e)?t.filter(t=>t!==e):[...t,e])},clearSelectedTraces:()=>{x([])}}}({data:l,columns:I});r.useEffect(()=>{b.setPageSize(10)},[b]),r.useId(),(0,n.FR)((0,n.MS)(n.cA,{}),(0,n.MS)(n.IG,{}),(0,n.MS)(n.uN,{}));let v=(0,x.useRouter)(),y=e=>{sessionStorage.setItem("tracesTableScrollPosition",window.scrollY.toString()),sessionStorage.setItem("tracesTableState",JSON.stringify({pagination:b.getState().pagination,sorting:b.getState().sorting,columnFilters:b.getState().columnFilters})),v.push("/trace?id=".concat(e),{scroll:!1})};return r.useEffect(()=>{let e=sessionStorage.getItem("tracesTableState");if(e)try{let{pagination:t,sorting:a,columnFilters:s}=JSON.parse(e);t&&b.setPagination(t),a&&b.setSorting(a),s&&b.setColumnFilters(s)}catch(e){console.error("Error restoring table state:",e)}let t=sessionStorage.getItem("tracesTableScrollPosition");t&&window.scrollTo(0,parseInt(t))},[b]),(0,s.jsx)(M.tU,{defaultValue:"outline",className:"w-full h-full flex flex-col",children:(0,s.jsxs)(M.av,{value:"outline",className:"relative flex flex-col h-full",children:[(0,s.jsx)("div",{className:"flex flex-col w-full h-full",children:(0,s.jsx)("div",{className:"w-full flex-1 overflow-hidden flex flex-col",children:(0,s.jsx)("div",{className:"w-full flex-1 overflow-auto",children:(0,s.jsx)("div",{className:"inline-block min-w-full",children:(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)("div",{className:"sticky top-0 z-10 bg-muted border-b",children:(0,s.jsx)("table",{className:"min-w-full table-fixed border-separate border-spacing-0",children:(0,s.jsx)("thead",{children:b.getHeaderGroups().map(e=>(0,s.jsx)("tr",{children:e.headers.map((e,t)=>(0,s.jsx)("th",{scope:"col",className:(0,h.cn)("text-base font-semibold px-4 py-3 text-left whitespace-nowrap border-b bg-muted/60",0===t&&"sticky left-0 z-20 bg-muted"),style:{width:150!==e.getSize()?"".concat(e.getSize(),"px"):void 0},tabIndex:0,children:e.isPlaceholder?null:(0,o.Kv)(e.column.columnDef.header,e.getContext())},e.id))},e.id))})})}),(0,s.jsx)("table",{className:"min-w-full table-fixed border-separate border-spacing-0",children:(0,s.jsx)("tbody",{className:"bg-background",children:(null==(t=b.getRowModel().rows)?void 0:t.length)?(0,s.jsx)(i.gB,{items:l.map(e=>e.id),strategy:i._G,children:b.getRowModel().rows.map(e=>(0,s.jsx)(O,{row:e,onRowClick:y},e.id))}):(0,s.jsx)("tr",{children:(0,s.jsx)("td",{colSpan:b.getAllColumns().length,className:"h-24 text-center border-b text-muted-foreground",children:(0,s.jsx)("span",{className:"inline-flex items-center gap-2",children:"No results found."})})})})})]})})})})}),(0,s.jsx)("div",{className:"bg-background py-2 px-4 flex-shrink-0 sticky bottom-0 z-10 shadow-[0_-2px_10px_rgba(0,0,0,0.1)] dark:shadow-[0_-2px_10px_rgba(0,0,0,0.25)]",children:(0,s.jsx)("div",{className:"flex items-center justify-between",children:(0,s.jsxs)("div",{className:"flex items-center gap-8 ml-auto",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(w,{htmlFor:"rows-per-page",className:"text-base font-medium",children:"Rows per page"}),(0,s.jsxs)(E,{value:"".concat(b.getState().pagination.pageSize),onValueChange:e=>{b.setPageSize(Number(e))},children:[(0,s.jsx)(T,{size:"sm",className:"w-20 text-base",id:"rows-per-page",children:(0,s.jsx)(C,{placeholder:b.getState().pagination.pageSize})}),(0,s.jsx)(z,{side:"top",children:[10,20,30,40,50].map(e=>(0,s.jsx)(A,{value:"".concat(e),className:"text-base",children:e},e))})]})]}),(0,s.jsxs)("div",{className:"flex items-center justify-center text-base font-medium",children:["Page ",b.getState().pagination.pageIndex+1," of"," ",b.getPageCount()]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsxs)(j.$,{variant:"outline",className:"hidden h-8 w-8 p-0 lg:flex",onClick:()=>b.setPageIndex(0),disabled:!b.getCanPreviousPage(),children:[(0,s.jsx)("span",{className:"sr-only",children:"Go to first page"}),(0,s.jsx)(d.A,{className:"h-4 w-4"})]}),(0,s.jsxs)(j.$,{variant:"outline",className:"h-8 w-8 p-0",onClick:()=>b.previousPage(),disabled:!b.getCanPreviousPage(),children:[(0,s.jsx)("span",{className:"sr-only",children:"Go to previous page"}),(0,s.jsx)(c.A,{className:"h-4 w-4"})]}),(0,s.jsxs)(j.$,{variant:"outline",className:"h-8 w-8 p-0",onClick:()=>b.nextPage(),disabled:!b.getCanNextPage(),children:[(0,s.jsx)("span",{className:"sr-only",children:"Go to next page"}),(0,s.jsx)(u.A,{className:"h-4 w-4"})]}),(0,s.jsxs)(j.$,{variant:"outline",className:"hidden h-8 w-8 p-0 lg:flex",onClick:()=>b.setPageIndex(b.getPageCount()-1),disabled:!b.getCanNextPage(),children:[(0,s.jsx)("span",{className:"sr-only",children:"Go to last page"}),(0,s.jsx)(m.A,{className:"h-4 w-4"})]})]})]})})})]})})}function D(){return(0,s.jsx)("header",{className:"flex h-(--header-height) shrink-0 items-center gap-2 border-b transition-[width,height] ease-linear group-has-data-[collapsible=icon]/sidebar-wrapper:h-(--header-height)",children:(0,s.jsx)("div",{className:"flex w-full items-center gap-1 px-4 lg:gap-2 lg:px-6",children:(0,s.jsx)("h1",{className:"text-base font-medium",children:"Agen Sight Studio"})})})}var V=a(2085);function L(e){let{className:t,type:a,...r}=e;return(0,s.jsx)("input",{type:a,"data-slot":"input",className:(0,h.cn)("file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input flex h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm","focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]","aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",t),...r})}a(8856);var K=a(6102);let G=r.createContext(null);function $(e){let{defaultOpen:t=!0,open:a,onOpenChange:n,className:i,style:o,children:l,...d}=e,c=function(){let[e,t]=r.useState(void 0);return r.useEffect(()=>{let e=window.matchMedia("(max-width: ".concat(767,"px)")),a=()=>{t(window.innerWidth<768)};return e.addEventListener("change",a),t(window.innerWidth<768),()=>e.removeEventListener("change",a)},[]),!!e}(),[u,m]=r.useState(!1),[x,g]=r.useState(t),p=null!=a?a:x,f=r.useCallback(e=>{let t="function"==typeof e?e(p):e;n?n(t):g(t),document.cookie="".concat("sidebar_state","=").concat(t,"; path=/; max-age=").concat(604800)},[n,p]),b=r.useCallback(()=>c?m(e=>!e):f(e=>!e),[c,f,m]);r.useEffect(()=>{let e=e=>{"b"===e.key&&(e.metaKey||e.ctrlKey)&&(e.preventDefault(),b())};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[b]);let v=p?"expanded":"collapsed",j=r.useMemo(()=>({state:v,open:p,setOpen:f,isMobile:c,openMobile:u,setOpenMobile:m,toggleSidebar:b}),[v,p,f,c,u,m,b]);return(0,s.jsx)(G.Provider,{value:j,children:(0,s.jsx)(K.Bc,{delayDuration:0,children:(0,s.jsx)("div",{"data-slot":"sidebar-wrapper",style:{"--sidebar-width":"16rem","--sidebar-width-icon":"3rem",...o},className:(0,h.cn)("group/sidebar-wrapper has-data-[variant=inset]:bg-sidebar flex min-h-svh w-full",i),...d,children:l})})})}function U(e){let{className:t,...a}=e;return(0,s.jsx)("main",{"data-slot":"sidebar-inset",className:(0,h.cn)("bg-background relative flex w-full flex-1 flex-col","md:peer-data-[variant=inset]:m-2 md:peer-data-[variant=inset]:ml-0 md:peer-data-[variant=inset]:rounded-xl md:peer-data-[variant=inset]:shadow-sm md:peer-data-[variant=inset]:peer-data-[state=collapsed]:ml-2",t),...a})}(0,V.F)("peer/menu-button flex w-full items-center gap-2 overflow-hidden rounded-md p-2 text-left text-sm outline-hidden ring-sidebar-ring transition-[width,height,padding] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 group-has-data-[sidebar=menu-action]/menu-item:pr-8 aria-disabled:pointer-events-none aria-disabled:opacity-50 data-[active=true]:bg-sidebar-accent data-[active=true]:font-medium data-[active=true]:text-sidebar-accent-foreground data-[state=open]:hover:bg-sidebar-accent data-[state=open]:hover:text-sidebar-accent-foreground group-data-[collapsible=icon]:size-8! group-data-[collapsible=icon]:p-2! [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0",{variants:{variant:{default:"hover:bg-sidebar-accent hover:text-sidebar-accent-foreground",outline:"bg-background shadow-[0_0_0_1px_hsl(var(--sidebar-border))] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground hover:shadow-[0_0_0_1px_hsl(var(--sidebar-accent))]"},size:{default:"h-8 text-sm",sm:"h-7 text-xs",lg:"h-12 text-sm group-data-[collapsible=icon]:p-0!"}},defaultVariants:{variant:"default",size:"default"}});var W=a(4211),q=a(7916),J=a(3306),X=a(7581);function Z(e){let{agents:t=[],connections:a=[],onNodeClick:n}=e,i=(0,W.VH)(),[o,l]=(0,r.useState)(!1);(0,r.useEffect)(()=>{let e=()=>{let e=document.documentElement.classList.contains("dark");console.log("Dark mode detected:",e),l(e)};e();let t=new MutationObserver(e);return t.observe(document.documentElement,{attributes:!0,attributeFilter:["class"]}),()=>t.disconnect()},[]);let d=o?["rgba(37, 99, 235, 0.5)","rgba(16, 185, 129, 0.5)","rgba(139, 92, 246, 0.5)","rgba(236, 72, 153, 0.5)","rgba(245, 158, 11, 0.5)"]:["#2563eb","#10b981","#8b5cf6","#ec4899","#f59e0b"],c=o?"rgba(34, 197, 94, 0.5)":"#22c55e",u=o?"rgba(239, 68, 68, 0.5)":"#ef4444",m=o?"rgba(16, 185, 129, 0.6)":"#10b981",x=o?"rgba(34, 197, 94, 0.6)":"#22c55e",h=o?"rgba(239, 68, 68, 0.6)":"#ef4444",g=(0,r.useRef)(!1),p=(0,r.useCallback)(()=>{let e=new Set(a.map(e=>e.from)),t=new Set(a.map(e=>e.to)),s=a.some(e=>"Start"===e.from),r=a.some(e=>"End"===e.to),n=[];e.forEach(e=>{"Start"!==e&&(t.has(e)||"End"===e)||n.push(e)});let i=[];return t.forEach(t=>{"End"!==t&&(e.has(t)||"Start"===t)||i.push(t)}),{startNodes:n,endNodes:i,hasExplicitStartNode:s,hasExplicitEndNode:r}},[a]),f=(0,r.useCallback)(()=>{let{startNodes:e,endNodes:a,hasExplicitStartNode:s,hasExplicitEndNode:r}=p(),n=t.filter(e=>"Start"!==e.name&&"End"!==e.name).map((e,t)=>({id:e.name,data:{label:e.name},position:{x:150+t%3*250,y:100+150*Math.floor(t/3)},style:{background:d[t%d.length],color:"#fff",padding:"10px 15px",borderRadius:"8px",width:180,textAlign:"center",fontWeight:"bold",boxShadow:"0 2px 5px rgba(0,0,0,0.1)",backdropFilter:o?"blur(8px)":"none",border:o?"1px solid rgba(255, 255, 255, 0.1)":"none"}})),i=[...n];return s?i.unshift({id:"Start",data:{label:"START"},position:{x:150,y:0},style:{background:c,color:"#fff",padding:"10px 15px",borderRadius:"8px",width:120,textAlign:"center",fontWeight:"bold",boxShadow:"0 2px 5px rgba(0,0,0,0.1)",backdropFilter:o?"blur(8px)":"none",border:o?"1px solid rgba(255, 255, 255, 0.1)":"none"}}):e.length>0&&i.unshift({id:"__start__",data:{label:"START"},position:{x:150,y:0},style:{background:c,color:"#fff",padding:"10px 15px",borderRadius:"8px",width:120,textAlign:"center",fontWeight:"bold",boxShadow:"0 2px 5px rgba(0,0,0,0.1)",backdropFilter:o?"blur(8px)":"none",border:o?"1px solid rgba(255, 255, 255, 0.1)":"none"}}),r?i.push({id:"End",data:{label:"END"},position:{x:150,y:100+150*Math.ceil(n.length/3)},style:{background:u,color:"#fff",padding:"10px 15px",borderRadius:"8px",width:120,textAlign:"center",fontWeight:"bold",boxShadow:"0 2px 5px rgba(0,0,0,0.1)",backdropFilter:o?"blur(8px)":"none",border:o?"1px solid rgba(255, 255, 255, 0.1)":"none"}}):a.length>0&&i.push({id:"__end__",data:{label:"END"},position:{x:150,y:100+150*Math.ceil(n.length/3)},style:{background:u,color:"#fff",padding:"10px 15px",borderRadius:"8px",width:120,textAlign:"center",fontWeight:"bold",boxShadow:"0 2px 5px rgba(0,0,0,0.1)",backdropFilter:o?"blur(8px)":"none",border:o?"1px solid rgba(255, 255, 255, 0.1)":"none"}}),i},[t,d,p,o,c,u]),b=(0,r.useCallback)(()=>{let{startNodes:e,endNodes:t,hasExplicitStartNode:s,hasExplicitEndNode:r}=p(),n=[...a.map((e,t)=>({id:"e".concat(t),source:e.from,target:e.to,type:"default",animated:!0,style:{stroke:"Start"===e.from?x:"End"===e.to?h:m,strokeWidth:2},markerEnd:{type:W.TG.ArrowClosed,width:15,height:15,color:"Start"===e.from?x:"End"===e.to?h:m}}))];return!s&&e.length>0&&e.forEach((e,t)=>{"Start"===e||a.some(t=>"Start"===t.from&&t.to===e)||n.push({id:"start-".concat(t),source:"__start__",target:e,type:"default",animated:!0,style:{stroke:x,strokeWidth:2},markerEnd:{type:W.TG.ArrowClosed,width:15,height:15,color:x}})}),!r&&t.length>0&&t.forEach((e,t)=>{"End"===e||a.some(t=>t.from===e&&"End"===t.to)||n.push({id:"end-".concat(t),source:e,target:"__end__",type:"default",animated:!0,style:{stroke:h,strokeWidth:2},markerEnd:{type:W.TG.ArrowClosed,width:15,height:15,color:h}})}),n},[a,p,m,x,h]),v=f(),j=b(),[y,w,N]=(0,W.ck)(v),[k,S,_]=(0,W.fM)(j);(0,r.useEffect)(()=>{!g.current&&t.length>0&&(w(f()),S(b()),g.current=!0)},[t,a,f,b]),(0,r.useEffect)(()=>{g.current&&i&&(w(f()),S(b()))},[o]);let E=(0,r.useRef)(null);return(0,r.useEffect)(()=>(y.length>0&&i&&(E.current&&clearTimeout(E.current),E.current=setTimeout(()=>{i.fitView({padding:.5,minZoom:.3,maxZoom:1.5}),E.current=null},100)),()=>{E.current&&clearTimeout(E.current)}),[y.length,i]),(0,r.useCallback)((e,t)=>{n&&"__start__"!==t.id&&"__end__"!==t.id&&"Start"!==t.id&&"End"!==t.id&&n(t.id)},[n]),(0,s.jsx)("div",{style:{width:"100%",height:"100%"},children:(0,s.jsxs)(W.Gc,{nodes:y,edges:k,onNodesChange:N,onEdgesChange:_,onNodeClick:(e,t)=>{"__start__"!==t.id&&"__end__"!==t.id&&"Start"!==t.id&&"End"!==t.id&&n&&n(t.id)},fitView:!0,children:[(0,s.jsx)(q.V,{color:o?"#4a5568":"#e2e8f0",gap:16,size:1,style:{backgroundColor:o?"rgba(15, 23, 42, 0.9)":"white"}}),(0,s.jsx)(J.H,{}),(0,s.jsx)(X.o,{nodeStrokeColor:e=>{var t;return(null==(t=e.style)?void 0:t.background)||"#eee"},nodeColor:e=>{var t;return(null==(t=e.style)?void 0:t.background)||"#eee"},zoomable:!0,pannable:!0})]})})}function B(e){return e.agents&&0!==e.agents.length?(0,s.jsx)("div",{className:"h-[500px] border rounded-xl overflow-hidden bg-background",children:(0,s.jsx)(W.Ln,{children:(0,s.jsx)(Z,{...e})})}):(0,s.jsx)("div",{className:"flex items-center justify-center h-[400px] bg-card/30 backdrop-blur-sm rounded-xl border border-border",children:(0,s.jsx)("p",{className:"text-muted-foreground",children:"No agents available to display"})})}a(1687);var H=a(5452),Q=a(4416);function Y(e){let{...t}=e;return(0,s.jsx)(H.bL,{"data-slot":"dialog",...t})}function ee(e){let{...t}=e;return(0,s.jsx)(H.ZL,{"data-slot":"dialog-portal",...t})}function et(e){let{className:t,...a}=e;return(0,s.jsx)(H.hJ,{"data-slot":"dialog-overlay",className:(0,h.cn)("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50 backdrop-blur-sm",t),...a})}function ea(e){let{className:t,children:a,...r}=e;return(0,s.jsxs)(ee,{children:[(0,s.jsx)(et,{}),(0,s.jsxs)(H.UC,{"data-slot":"dialog-content",className:(0,h.cn)("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed left-[50%] top-[50%] z-50 grid w-full max-w-3xl translate-x-[-50%] translate-y-[-50%] gap-4 shadow-lg duration-200 sm:rounded-lg border-0 !border-none p-6",t),style:{border:"none"},...r,children:[a,(0,s.jsxs)(H.bm,{className:"ring-offset-background focus:ring-ring data-[state=open]:bg-secondary absolute right-4 top-4 rounded-sm opacity-70 transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-offset-2 disabled:pointer-events-none",children:[(0,s.jsx)(Q.A,{className:"size-4"}),(0,s.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})}function es(e){let{className:t,...a}=e;return(0,s.jsx)("div",{"data-slot":"dialog-header",className:(0,h.cn)("flex flex-col space-y-1.5 border-b border-border px-6 py-4",t),...a})}function er(e){let{className:t,...a}=e;return(0,s.jsx)("div",{"data-slot":"dialog-footer",className:(0,h.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2 border-t border-border px-6 py-4",t),...a})}function en(e){let{className:t,...a}=e;return(0,s.jsx)(H.hE,{"data-slot":"dialog-title",className:(0,h.cn)("text-lg font-semibold",t),...a})}function ei(e){let{className:t,...a}=e;return(0,s.jsx)(H.VY,{"data-slot":"dialog-description",className:(0,h.cn)("text-sm text-muted-foreground",t),...a})}var eo=a(5028),el=a(5710),ed=a(6068),ec=a(8628),eu=a(9939),em=a(5548);let ex="http://0.0.0.0:5001/api";async function eh(){try{let e=await fetch("".concat(ex,"/config/versions"));if(!e.ok)throw Error("Error fetching config versions: ".concat(e.statusText));return await e.json()}catch(e){throw console.error("Failed to fetch config versions:",e),e}}async function eg(e){try{let t=await fetch("".concat(ex,"/config?version=").concat(encodeURIComponent(e)));if(!t.ok)throw Error("Error fetching config version ".concat(e,": ").concat(t.statusText));return await t.json()}catch(t){throw console.error("Failed to fetch config version ".concat(e,":"),t),t}}async function ep(e){try{let t=await fetch("".concat(ex,"/config/sync"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({version:e})});if(!t.ok)throw Error("Error syncing config version ".concat(e,": ").concat(t.statusText));return await t.json()}catch(t){throw console.error("Failed to sync config version ".concat(e,":"),t),t}}async function ef(e){try{let t=await fetch("".concat(ex,"/config/commit"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok)throw Error("Error committing config version: ".concat(t.statusText));return await t.json()}catch(e){throw console.error("Failed to commit config version:",e),e}}async function eb(e){try{e.config_version&&(e.config_version=String(e.config_version)),console.log("In config.ts updateAgent - Sending data:",JSON.stringify(e,null,2)),console.log("Config version type:",typeof e.config_version);let t=await fetch("".concat(ex,"/update_agent"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok){console.error("Error response from update_agent:",t.status,t.statusText);let e=await t.text();throw console.error("Error body:",e),Error("Error updating agent: ".concat(t.statusText))}let a=await t.json();return console.log("Update agent response:",a),a}catch(e){throw console.error("Failed to update agent:",e),e}}var ev=a(8262);let ej=(0,eo.default)(()=>Promise.all([a.e(827),a.e(918)]).then(a.bind(a,5918)).then(e=>e.default),{loadableGenerated:{webpack:()=>[null]},ssr:!1}),ey=[{value:"gpt-4o-mini",label:"GPT-4o Mini"},{value:"gpt-3.5-turbo",label:"GPT-3.5 Turbo"},{value:"gpt-4o",label:"GPT-4o"},{value:"gpt-4-turbo",label:"GPT-4 Turbo"}];function ew(e){let{agent:t,setSelectedAgent:a,configVersion:n,onSave:i}=e,[o,l]=(0,r.useState)(""),[d,c]=(0,r.useState)(!1),[u,m]=(0,r.useState)(""),[x,h]=(0,r.useState)(0),[g,p]=(0,r.useState)(0),[b,v]=(0,r.useState)(0),[y,N]=(0,r.useState)("prompt"),[k,S]=(0,r.useState)(!1),[_,P]=(0,r.useState)({}),F=(0,r.useMemo)(()=>t&&"object"==typeof t&&t.name,[t]),I=(0,r.useMemo)(()=>F&&t.prompt||"",[t,F]);(0,r.useEffect)(()=>{l(I)},[I]),(0,r.useEffect)(()=>{c(F)},[F]),(0,r.useEffect)(()=>{F&&l(t.prompt||"")},[t,F]),(0,r.useEffect)(()=>{F&&t&&c(!0)},[t,F]);let O=(0,r.useMemo)(()=>{var e,a,s,r;return{model:(null==t||null==(e=t.modelParams)?void 0:e.model)||ey[0].value,temperature:(null==t||null==(a=t.modelParams)?void 0:a.temperature)||0,topP:(null==t||null==(s=t.modelParams)?void 0:s.top_p)||1,maxTokens:(null==t||null==(r=t.modelParams)?void 0:r.max_tokens)||2e3}},[t]);(0,r.useEffect)(()=>{m(O.model),h(O.temperature),p(O.topP),v(O.maxTokens)},[O]);let R=(0,r.useMemo)(()=>F&&t.variables||[],[t,F]),D=(0,r.useCallback)(e=>{c(e),e||a(null)},[a]),V=(0,r.useCallback)(()=>{c(!1),a(null)},[a]),K=(0,r.useCallback)(async()=>{if(!F)return;S(!0),P({});let e={...t,prompt:o,variables:R,modelParams:{model:u,temperature:x,top_p:g,max_tokens:b}};try{if(i)await i(e),V();else{if(!n)return void console.error("No version specified for updating agent");console.log("Updating agent with data:",{agent:e,config_version:n});let a=await eb({agent:e,config_version:n});a.success?((0,ev.oR)({title:"Success",description:"Agent ".concat(t.name," updated successfully in ").concat(a.version||"current version"),duration:3e3}),V()):(0,ev.oR)({title:"Error",description:a.message||"Failed to update agent",variant:"destructive",duration:3e3})}}catch(e){console.error("Error saving agent:",e),(0,ev.oR)({title:"Error",description:e instanceof Error?e.message:"Failed to update agent",variant:"destructive",duration:3e3})}finally{S(!1)}},[F,t,o,R,u,x,g,b,i,n,V]);return F?(0,s.jsx)(Y,{open:d,onOpenChange:D,children:(0,s.jsxs)(ea,{className:"max-w-4xl p-0 gap-0 overflow-hidden bg-background border-0 !border-none sm:rounded-xl",children:[(0,s.jsx)(es,{className:"px-6 py-4 border-b border-border/50",children:(0,s.jsx)("div",{className:"flex items-center justify-between",children:(0,s.jsxs)("div",{className:"pr-8",children:[(0,s.jsxs)(en,{className:"text-xl font-semibold flex items-center gap-2",children:[t.name,n&&(0,s.jsxs)(f.E,{variant:"outline",className:"text-xs",children:["Config v",n]})]}),(0,s.jsx)(ei,{className:"mt-1 text-sm text-slate-500",children:"Define this agent's behavior through prompts and model parameters"})]})})}),(0,s.jsx)("div",{className:"w-full h-[70vh] flex flex-col",children:(0,s.jsxs)(M.tU,{defaultValue:"prompt",value:y,onValueChange:N,className:"flex flex-col h-full",children:[(0,s.jsx)("div",{className:"border-b border-border/50 bg-card/40 backdrop-blur-sm",children:(0,s.jsx)("div",{className:"px-6",children:(0,s.jsxs)(M.j7,{className:"p-1 h-10 bg-transparent space-x-6 border-0",children:[(0,s.jsxs)(M.Xi,{value:"prompt",className:"px-4 py-2 data-[state=active]:bg-blue-500 dark:data-[state=active]:bg-white/20 data-[state=active]:text-white rounded-md transition-all font-medium",children:[(0,s.jsx)(ed.A,{className:"w-4 h-4 mr-2"}),"Prompt"]}),(0,s.jsxs)(M.Xi,{value:"variables",className:"px-4 py-2 data-[state=active]:bg-blue-500 dark:data-[state=active]:bg-white/20 data-[state=active]:text-white rounded-md transition-all font-medium",children:[(0,s.jsx)(ec.A,{className:"w-4 h-4 mr-2"}),"Variables"]}),(0,s.jsxs)(M.Xi,{value:"settings",className:"px-4 py-2 data-[state=active]:bg-blue-500 dark:data-[state=active]:bg-white/20 data-[state=active]:text-white rounded-md transition-all font-medium",children:[(0,s.jsx)(eu.A,{className:"w-4 h-4 mr-2"}),"Settings"]})]})})}),(0,s.jsxs)("div",{className:"flex-1 overflow-hidden",children:[(0,s.jsx)(M.av,{value:"prompt",className:"h-full flex-1 m-0 p-0 data-[state=active]:flex flex-col",children:(0,s.jsx)("div",{className:"flex-grow overflow-y-auto p-6",children:(0,s.jsx)("div",{"data-color-mode":"light",className:"w-full h-full",children:(0,s.jsx)(ej,{value:o,onChange:e=>l(e||""),height:"calc(100% - 24px)",preview:"edit",previewOptions:{rehypePlugins:[[el.A]]}})})})}),(0,s.jsx)(M.av,{value:"variables",className:"h-full flex-1 m-0 data-[state=active]:flex flex-col",children:(0,s.jsxs)("div",{className:"flex-grow overflow-y-auto p-6",children:[(0,s.jsxs)("div",{className:"mb-4",children:[(0,s.jsx)("h3",{className:"text-base font-semibold mb-2",children:"Available Variables"}),(0,s.jsxs)("p",{className:"text-sm text-slate-500 mb-4",children:["These variables can be used in your prompt with ","{variable_name}"," syntax"]})]}),R.length>0?(0,s.jsx)("div",{className:"grid grid-cols-2 gap-3",children:R.map(e=>(0,s.jsxs)("div",{className:"bg-white dark:bg-slate-800 p-3 rounded border flex items-center shadow-sm",children:[(0,s.jsx)("div",{className:"bg-blue-50 dark:bg-blue-900 rounded-md p-1 mr-2",children:(0,s.jsx)(ec.A,{className:"w-4 h-4 text-blue-600 dark:text-blue-400"})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm font-medium",children:e}),(0,s.jsx)("code",{className:"text-xs text-pink-600 dark:text-pink-400",children:"{".concat(e,"}")})]})]},e))}):(0,s.jsxs)("div",{className:"p-8 text-center bg-card rounded-lg border-0",children:[(0,s.jsx)("p",{className:"text-sm text-slate-500",children:"No variables found in this prompt"}),(0,s.jsxs)("p",{className:"text-xs text-slate-400 mt-1",children:["Add variables by using ","{variable_name}"," syntax in your prompt"]})]})]})}),(0,s.jsx)(M.av,{value:"settings",className:"h-full flex-1 m-0 data-[state=active]:flex flex-col",children:(0,s.jsxs)("div",{className:"flex-grow overflow-y-auto p-6",children:[(0,s.jsx)("div",{className:"mb-6",children:(0,s.jsx)("h3",{className:"text-base font-semibold mb-3",children:"Model Configuration"})}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(w,{htmlFor:"model",className:"mb-2 text-sm font-medium block",children:"Model"}),(0,s.jsxs)(E,{value:u,onValueChange:m,children:[(0,s.jsx)(T,{id:"model",className:"w-full",children:(0,s.jsx)(C,{placeholder:"Select a model"})}),(0,s.jsx)(z,{children:ey.map(e=>(0,s.jsx)(A,{value:e.value,children:e.label},e.value))})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(w,{htmlFor:"max_tokens",className:"mb-2 text-sm font-medium block",children:"Max Tokens"}),(0,s.jsx)(L,{id:"max_tokens",type:"number",min:1,value:b,onChange:e=>v(Number(e.target.value))})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(w,{htmlFor:"temperature",className:"mb-2 text-sm font-medium block",children:"Temperature"}),(0,s.jsx)(L,{id:"temperature",type:"number",step:"0.01",min:0,max:2,value:x,onChange:e=>h(Number(e.target.value))})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(w,{htmlFor:"top_p",className:"mb-2 text-sm font-medium block",children:"Top P"}),(0,s.jsx)(L,{id:"top_p",type:"number",step:"0.01",min:0,max:1,value:g,onChange:e=>p(Number(e.target.value))})]})]})]})})]})]})}),(0,s.jsxs)(er,{className:"px-6 py-4 border-t border-border/50",children:[(0,s.jsx)("div",{className:"flex-1",children:(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(em.A,{className:"w-4 h-4 text-slate-500"}),(0,s.jsx)("span",{className:"text-sm text-slate-500",children:n&&"current"!==n?"Editing version ".concat(n):"Editing current version"})]})}),(0,s.jsx)(j.$,{variant:"outline",onClick:V,children:"Cancel"}),(0,s.jsx)(j.$,{onClick:K,className:"ml-2",children:"Save Changes"})]})]})}):null}var eN=a(5779),ek=a(6236),eS=a(6217),e_=a(6981);let eE=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(e_.bL,{ref:t,className:(0,h.cn)("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",a),...r,children:(0,s.jsx)(e_.C1,{className:(0,h.cn)("flex items-center justify-center text-current"),children:(0,s.jsx)(S.A,{className:"h-3.5 w-3.5"})})})});eE.displayName=e_.bL.displayName;var eC=a(7280),eT=a(6715),ez=a(2960),eA=a(5041);async function eP(e){try{let t=await fetch("".concat("http://0.0.0.0:5001/api","/update_agent"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok)throw Error("Error updating agent: ".concat(t.statusText));return await t.json()}catch(e){throw console.error("Failed to update agent:",e),e}}var eF=a(7652);function eM(){let{darkMode:e,toggleDarkMode:t}=(0,eC.D)(),[a,n]=(0,r.useState)(null),[i,o]=(0,r.useState)(null),[l,d]=(0,r.useState)(!0),[c,u]=(0,r.useState)(null),[m,x]=(0,r.useState)([]),[h,g]=(0,r.useState)(""),[p,f]=(0,r.useState)(!1),[b,v]=(0,r.useState)(""),[y,N]=(0,r.useState)(!0),[k,S]=(0,r.useState)(!1),[_,C]=(0,r.useState)(!1),[P,F]=(0,r.useState)(()=>{{let e=sessionStorage.getItem("dashboardActiveTab");return e&&sessionStorage.removeItem("dashboardActiveTab"),e||"experiments"}}),[I,O]=(0,r.useState)([]),[V,G]=(0,r.useState)(!1),W=(0,eT.jE)(),{data:q,isLoading:J,error:X,refetch:Z}=(0,ez.I)({queryKey:["config-versions"],queryFn:eh});(0,r.useEffect)(()=>{if(q){let e=q.filter(e=>"current"!==e.version&&e.version.match(/^\d+\.\d+\.\d+$/));e.sort((e,t)=>t.version.localeCompare(e.version,void 0,{numeric:!0})),x(e),e.length>0&&!h&&g(e[0].version)}},[q,h]);let{data:H,isLoading:Q,error:ee}=(0,ez.I)({queryKey:["config",h],queryFn:()=>eg(h),enabled:!!h});(0,r.useEffect)(()=>{H&&n(H)},[H]);let et=(0,eA.n)({mutationFn:ep,onSuccess:()=>{(0,ev.oR)({title:"Success",description:"Synced version ".concat(h," to main config"),duration:3e3}),W.invalidateQueries({queryKey:["config-versions"]})},onError:e=>{(0,ev.oR)({title:"Error",description:"Failed to sync to main config",variant:"destructive",duration:3e3})}}),eo=(0,eA.n)({mutationFn:ef,onSuccess:e=>{(0,ev.oR)({title:"Success",description:"Created version ".concat(null==e?void 0:e.version),duration:3e3}),f(!1),W.invalidateQueries({queryKey:["config-versions"]}),g(e.version)},onError:e=>{(0,ev.oR)({title:"Error",description:"Failed to commit new version",variant:"destructive",duration:3e3})}}),el=(0,eA.n)({mutationFn:eP,onSuccess:(e,t)=>{(0,ev.oR)({title:"Success",description:"Agent updated successfully to version ".concat(e.version),duration:3e3}),W.invalidateQueries({queryKey:["config",e.version]}),e.version!==h&&g(e.version)},onError:e=>{(0,ev.oR)({title:"Error",description:"Failed to update agent",variant:"destructive",duration:3e3})}}),{data:ed,isLoading:ec,error:eu,refetch:ex}=(0,ez.I)({queryKey:["traces"],queryFn:eF._K,enabled:"traces"===P});(0,r.useEffect)(()=>{ed&&O(ed)},[ed]);let eb=async e=>{e&&et.mutate(e)},ej=async()=>b.trim()?h?void eo.mutate({commit_message:b,sync_to_main:y,source_version:h}):void(0,ev.oR)({title:"Error",description:"No version selected to commit from",variant:"destructive",duration:3e3}):void(0,ev.oR)({title:"Error",description:"Please enter a commit message",variant:"destructive",duration:3e3}),ey=async e=>{el.mutate({agent:e,config_version:h})},e_=J||Q&&!!h;(0,r.useEffect)(()=>{console.log("activeTab changed:",P),"traces"===P&&ex()},[P,ex]);let eM=(0,r.useCallback)(e=>{(null==a?void 0:a.agents)&&(o(null),setTimeout(()=>{let t=a.agents.find(t=>t.name===e);t&&(o(t),C(!0))},10))},[a]),eI=(0,r.useCallback)(()=>{o(null),C(!1)},[]),eO=(0,r.useCallback)(()=>{v(""),N(!0),f(!0)},[]),eR=(0,r.useCallback)(e=>{f(e),e||(v(""),N(!0))},[]);return e_&&!a?(0,s.jsx)($,{style:{"--sidebar-width":"calc(var(--spacing) * 72)","--header-height":"calc(var(--spacing) * 12)"},children:(0,s.jsxs)(U,{children:[(0,s.jsx)(D,{}),(0,s.jsx)("div",{className:"flex items-center justify-center h-screen",children:(0,s.jsx)("div",{className:"text-center",children:(0,s.jsx)("p",{className:"text-slate-500",children:"Loading..."})})})]})}):X||ee?(0,s.jsx)($,{style:{"--sidebar-width":"calc(var(--spacing) * 72)","--header-height":"calc(var(--spacing) * 12)"},children:(0,s.jsxs)(U,{children:[(0,s.jsx)(D,{}),(0,s.jsx)("div",{className:"flex items-center justify-center h-screen",children:(0,s.jsx)("div",{className:"text-center",children:(0,s.jsx)("p",{className:"text-red-500",children:(null==X?void 0:X.message)||(null==ee?void 0:ee.message)})})})]})}):(0,s.jsxs)("div",{className:"min-h-screen flex flex-col",children:[(0,s.jsx)("main",{className:"flex-1 grid-bg",children:(0,s.jsxs)("div",{className:"container mx-auto py-6",children:[(0,s.jsxs)("div",{className:"mb-8 flex flex-col sm:flex-row sm:items-center gap-4 justify-between  pb-4",children:[(0,s.jsx)("div",{className:"flex-none",children:(0,s.jsx)(M.tU,{value:P,className:"w-full",onValueChange:e=>F(e),children:(0,s.jsxs)(M.j7,{className:"bg-white dark:bg-card p-1 rounded-lg shadow-sm",children:[(0,s.jsx)(M.Xi,{value:"experiments",className:"px-4 py-2 data-[state=active]:bg-blue-500 dark:data-[state=active]:bg-white/20 data-[state=active]:text-white rounded-md transition-all font-medium",children:"Experiments"}),(0,s.jsx)(M.Xi,{value:"traces",className:"px-4 py-2 data-[state=active]:bg-blue-500 dark:data-[state=active]:bg-white/20 data-[state=active]:text-white rounded-md transition-all font-medium",children:"Traces"}),(0,s.jsx)(M.Xi,{value:"evaluations",className:"px-4 py-2 data-[state=active]:bg-blue-500 dark:data-[state=active]:bg-white/20 data-[state=active]:text-white rounded-md transition-all font-medium",children:"Evaluations"})]})})}),(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row gap-3 ml-auto",children:[(0,s.jsx)("div",{className:"flex items-center",children:(0,s.jsxs)(E,{value:h,onValueChange:g,children:[(0,s.jsx)(T,{className:"w-[180px]",children:(0,s.jsxs)("div",{className:"flex items-center gap-1",children:[(0,s.jsx)(eN.A,{size:16}),(0,s.jsx)("span",{className:"font-medium",children:h})]})}),(0,s.jsx)(z,{children:m.map(e=>(0,s.jsx)(A,{value:e.version,children:(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("span",{className:"font-medium",children:e.version}),(0,s.jsx)("span",{className:"text-muted-foreground text-xs truncate",children:e.commit_message})]})},e.version))})]})}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(K.Bc,{children:(0,s.jsxs)(K.m_,{children:[(0,s.jsx)(K.k$,{asChild:!0,children:(0,s.jsxs)(j.$,{variant:"outline",size:"sm",onClick:()=>eb(h),disabled:J,id:"sync-button",className:"relative overflow-hidden group hover:border-primary/50 transition-all duration-300",children:[(0,s.jsx)("div",{className:"absolute inset-0 bg-gradient-to-r from-transparent via-primary/20 to-transparent -translate-x-full group-hover:translate-x-full transition-transform duration-1000 ease-in-out"}),(0,s.jsx)(em.A,{size:16,className:"mr-1 group-hover:text-primary transition-colors duration-300"}),(0,s.jsx)("span",{className:"relative z-10",children:"Sync"})]})}),(0,s.jsx)(K.ZI,{children:(0,s.jsx)("p",{children:"This will sync to main agensight.config.json file"})})]})}),(0,s.jsx)(K.Bc,{children:(0,s.jsxs)(K.m_,{children:[(0,s.jsx)(K.k$,{asChild:!0,children:(0,s.jsxs)(j.$,{variant:"outline",size:"sm",onClick:eO,disabled:J,children:[(0,s.jsx)(ek.A,{size:16,className:"mr-1"}),"Commit"]})}),(0,s.jsx)(K.ZI,{children:(0,s.jsx)("p",{children:"Save current state as a new version"})})]})})]})]})]}),(0,s.jsxs)("div",{className:"w-full",children:["experiments"===P&&(0,s.jsx)("div",{className:"grid grid-cols-1 gap-6 mb-8",children:(0,s.jsx)("div",{className:"relative",children:(0,s.jsx)("div",{className:"rounded-lg border border-border/40 bg-card/50 backdrop-blur-sm p-2 h-[550px] overflow-hidden",children:J?(0,s.jsx)("div",{className:"absolute inset-0 flex items-center justify-center",children:(0,s.jsx)("div",{className:"animate-spin h-8 w-8 border-4 border-primary border-t-transparent rounded-full"})}):c?(0,s.jsx)("div",{className:"absolute inset-0 flex items-center justify-center",children:(0,s.jsx)("div",{className:"text-destructive",children:c})}):a?(0,s.jsx)(B,{agents:a.agents||[],connections:a.connections||[],onNodeClick:eM}):null})})}),"traces"===P&&(0,s.jsx)("div",{className:"border rounded-lg flex flex-col bg-card/50 backdrop-blur-sm h-[550px] pb-0",children:ec?(0,s.jsx)("div",{className:"flex items-center justify-center h-full",children:(0,s.jsx)("div",{className:"animate-spin h-8 w-8 border-4 border-primary border-t-transparent rounded-full"})}):I&&I.length>0?(0,s.jsx)("div",{className:"flex-1 flex flex-col h-full",children:(0,s.jsx)(R,{data:I})}):(0,s.jsx)("div",{className:"text-center flex items-center justify-center h-full",children:(0,s.jsxs)("div",{children:[(0,s.jsx)(eS.A,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),(0,s.jsx)("h3",{className:"text-lg font-medium",children:"No traces available"}),(0,s.jsx)("p",{className:"text-muted-foreground mt-2",children:"Trace data will appear here when you run experiments"})]})})}),"evaluations"===P&&(0,s.jsx)("div",{className:"border rounded-lg p-8 flex items-center justify-center bg-card/50 backdrop-blur-sm h-[550px]",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)(eS.A,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),(0,s.jsx)("h3",{className:"text-lg font-medium",children:"No evaluation till now"}),(0,s.jsx)("p",{className:"text-muted-foreground mt-2",children:"Evaluation data will appear here when you run experiments"})]})})]})]})}),(0,s.jsx)(Y,{open:p,onOpenChange:eR,children:(0,s.jsxs)(ea,{children:[(0,s.jsxs)(es,{children:[(0,s.jsx)(en,{className:"text-xl font-semibold",children:"Create New Version"}),(0,s.jsx)(ei,{children:"Save the current configuration as a new version."})]}),(0,s.jsxs)("div",{className:"space-y-4 py-4 px-6",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(w,{htmlFor:"commit-message",className:"font-medium",children:"Commit Message"}),(0,s.jsx)(L,{id:"commit-message",placeholder:"Describe your changes",value:b,onChange:e=>v(e.target.value)})]}),(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)(eE,{id:"sync-to-main",checked:y,onCheckedChange:e=>{N(!0===e)}}),(0,s.jsx)(w,{htmlFor:"sync-to-main",className:"font-medium text-sm",children:"This will sync your changes to the agensight.config.json file"})]})]}),(0,s.jsxs)(er,{children:[(0,s.jsx)(j.$,{variant:"outline",onClick:()=>f(!1),children:"Cancel"}),(0,s.jsx)(j.$,{disabled:J,onClick:ej,children:J?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"mr-2 animate-spin h-4 w-4 border-2 border-background border-t-transparent rounded-full"}),"Committing..."]}):"Create Version"})]})]})}),(0,s.jsx)(Y,{open:_,onOpenChange:C,children:(0,s.jsxs)(ea,{className:"sm:max-w-[600px] max-h-[80vh] overflow-hidden border-0 !border-none bg-card/90 backdrop-blur-sm shadow-lg",style:{border:"none"},children:[(0,s.jsx)(es,{className:"border-0 !border-none",style:{borderBottom:"none"},children:(0,s.jsx)(en,{className:"text-xl font-semibold",children:(null==i?void 0:i.name)||"Agent Details"})}),(0,s.jsx)("div",{className:"overflow-auto py-4",children:i&&(0,s.jsx)(ew,{agent:i,setSelectedAgent:eI,configVersion:h,onSave:ey})})]})})]})}},8262:(e,t,a)=>{"use strict";a.d(t,{dj:()=>m,oR:()=>u});var s=a(2115);let r=0,n=new Map,i=(e,t)=>{if(n.has(e))return;let a=setTimeout(()=>{n.delete(e),c({type:"REMOVE_TOAST",toastId:e})},t||5e3);n.set(e,a)},o=(e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,5)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===t.toast.id?{...e,...t.toast}:e)};case"DISMISS_TOAST":{let{toastId:a}=t;if(a){let t=e.toasts.find(e=>e.id===a);i(a,null==t?void 0:t.duration)}else e.toasts.forEach(e=>{i(e.id,e.duration)});return{...e,toasts:e.toasts.map(e=>e.id===a||void 0===a?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===t.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==t.toastId)}}},l=[],d={toasts:[]};function c(e){d=o(d,e),l.forEach(e=>{e(d)})}function u(e){let{...t}=e,a=(r=(r+1)%Number.MAX_VALUE).toString(),s=()=>c({type:"DISMISS_TOAST",toastId:a});return 0!==t.duration&&setTimeout(()=>{s()},t.duration||5e3),c({type:"ADD_TOAST",toast:{...t,id:a,open:!0,onOpenChange:e=>{e||s()}}}),{id:a,dismiss:s,update:e=>c({type:"UPDATE_TOAST",toast:{...e,id:a}})}}function m(){let[e,t]=s.useState(d);return s.useEffect(()=>(l.push(t),()=>{let e=l.indexOf(t);e>-1&&l.splice(e,1)}),[e]),{...e,toast:u,dismiss:e=>c({type:"DISMISS_TOAST",toastId:e})}}},8856:(e,t,a)=>{"use strict";a.d(t,{E:()=>n});var s=a(5155),r=a(9434);function n(e){let{className:t,...a}=e;return(0,s.jsx)("div",{"data-slot":"skeleton",className:(0,r.cn)("bg-accent animate-pulse rounded-md",t),...a})}},9434:(e,t,a)=>{"use strict";a.d(t,{cn:()=>n});var s=a(2596),r=a(9688);function n(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return(0,r.QP)((0,s.$)(t))}}},e=>{var t=t=>e(e.s=t);e.O(0,[294,702,920,45,324,321,441,684,358],()=>t(4557)),_N_E=e.O()}]);